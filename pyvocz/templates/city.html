{% extends "base.html" %}
{% block title %}Pyvo {{ city.name }}{% endblock title %}

{% block bodyclass %}citypage{% endblock %}

{% block bodycontent %}
<div class="container">
    <h1>{{ self.title() }}</h1>

    {% block plan %}{% endblock plan %}
</div>

{% set event = city.events[0] %}

<div class="map-container">
<div id="map" class="container" style="height: 350px"
    data-src="{{ url_for('api_venue_geojson', venueslug=event.venue.slug) }}"
    data-zoom="14"
    data-lat="{{event.venue.latitude}}"
    data-lng="{{event.venue.longitude}}"
>
</div>
</div>

<div class="container">
    {% if event.date < today %}
         <h2>Poslední sraz</h2>
    {% else %}
         <h2>Nadcházející sraz</h2>
    {% endif %}

    {% set is_header_event = True %}
    {% include "fragments/event.html" %}
    {% set is_header_event = False %}

</div>

{% block contact %}{% endblock contact %}

<div class="container">
    <h2>Historie srazů</h2>
    <ul>
        {% for event in city.events[1:] %}
            <li>
                {% include "fragments/event.html" %}
            </li>
        {% endfor %}
    </ul>
</div>
{% endblock bodycontent %}

{% block styles %}
    {{ super() }}
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.css" />
{% endblock styles %}

{% block scripts %}
    <script>
        var require = {
            baseUrl: "{{ url_for('static', filename='') }}",
            deps: ["scripts/maps"],
        };
    </script>
    <script async
            src="{{ url_for('static', filename='third-party/require.js') }}"
    ></script>
{% endblock %}
